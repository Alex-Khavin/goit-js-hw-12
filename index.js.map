{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nconst API_KEY = \"49358798-a0fde913d86352b572e9384bf\";\nconst BASE_URL = \"https://pixabay.com/api/\";\n\nexport async function fetchData(query, page = 1) {\n    try {\n        const response = await axios.get(BASE_URL, {\n            params: {\n        key: API_KEY,\n        q: query,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: true,\n        per_page: 15,\n        page: page,\n        }\n        });\n\n        if (!response.data.hits.length) {\n            throw new Error(\"Sorry, there are no images matching your search query. Please try again!\");\n           }\n           return response.data;\n    } catch (error) {\n        iziToast.error({\n            message: `${error.message}`,\n            messageColor: 'white',\n            position: 'topRight',\n            color: '#ef4040',\n        });\n        return { hits: [], totalHits: 0 };\n    }\n};\n     \n","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nexport function markupImg(cards) {\n  return cards\n  .map(card => {\n    return `<li class=\"gallery-item\">\n    <a class=\"gallery-link\" href=\"${card.largeImageURL}\">\n    <img\n    class=\"gallery-image\"\n    src=\"${card.webformatURL}\"\n    alt=\"${card.tags.slice(0, 120)}\"\n    />\n    </a>\n    <div class=\"item-subtitle\">\n    <p class=\"item-text\"><b>Likes</b> ${card.likes}</p>\n    <p class=\"item-text\"><b>Views</b> ${card.views}</p>\n    <p class=\"item-text\"><b>Comments</b> ${card.comments}</p>\n    <p class=\"item-text\"><b>Downloads</b> ${card.downloads}</p>\n    </div>\n    </li>`;\n  })\n  .join(\"\");\n}\n\nexport let gallery = new SimpleLightbox('.gallery a', { captionsData: \"alt\", captionDelay: 250 });","import { fetchData } from \"./js/pixabay-api\";\nimport { markupImg } from \"./js/render-functions\"\nimport { gallery } from \"./js/render-functions\";\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nlet inputData = \"\";\nlet searchQuery = \"\";\nlet page = 1;\nlet totalPages = 1;\n\nconst formData = document.querySelector(\".form\");\nconst formInput = document.querySelector(\"input\");\nconst galleryList = document.querySelector(\".gallery\");\nconst loader = document.querySelector(\".loader\");\nconst btnLoadMore = document.querySelector(\".btn\");\n\n\nformData.addEventListener(\"submit\", formSubmit);\nformInput.addEventListener(\"input\", onInput);\nbtnLoadMore.addEventListener(\"click\", loadMore);\n\nfunction onInput(event) {\n    inputData = event.target.value.trim();\n};\n\nasync function formSubmit(event) {\n    event.preventDefault();\n    const form = event.currentTarget;\n    btnLoadMore.classList.add(\"hidden\");\n    page = 1;\n\n    if (inputData === \"\") {\n         iziToast.error({\n                message: 'Fill in the search field!',\n                messageColor: 'white',\n                position: 'topRight',\n                color: '#ef4040',\n         });\n        form.reset();\n        return;\n    }\n\n    searchQuery = inputData;\n    galleryList.innerHTML = \"\";\n    loader.classList.remove(\"hidden\");\n\n    try {\n        const { hits: images, totalHits } = await fetchData(inputData, page);\n        if (totalHits === 0) {\n        // iziToast.error({\n        //     message: 'Sorry, there are no images matching your search query. Please try again!',\n        //     messageColor: 'white',\n        //     position: 'topRight',\n        //     color: '#ef4040',\n        //     });\n        // form.reset();\n        return;\n        }\n        \n        totalPages = Math.ceil(totalHits / 15);\n\n        galleryList.insertAdjacentHTML(\"beforeend\", markupImg(images));\n        gallery.refresh();\n\n        if (page < totalPages) {\n            btnLoadMore.classList.remove(\"hidden\");\n        }\n    } catch (error) {\n        console.error(\"Error:\", error);\n    } finally {\n        loader.classList.add(\"hidden\");\n    }\n\n    form.reset();\n    inputData = \"\";\n};\n\nasync function loadMore() {\n    page += 1;\n    loader.classList.remove(\"hidden\");\n    \n    try {\n        const {hits: newImg} = await fetchData(searchQuery, page);\n        galleryList.insertAdjacentHTML(\"beforeend\", markupImg(newImg));\n        gallery.refresh();\n        \n        const itemHeight = document.querySelector(\".gallery-item\");\n        if (itemHeight) {\n            const cardHeight = itemHeight.getBoundingClientRect().height * 2;\n            window.scrollBy({ top: cardHeight, behavior: \"smooth\" });\n        }\n        \n        if (page === totalPages) {\n            iziToast.error({\n                position: \"topRight\",\n                message: \"We're sorry, but you've reached the end of search results.\",\n                messageColor: 'white',\n                color: '#ef4040',\n            });\n        btnLoadMore.classList.add(\"hidden\");\n    }\n  } catch (error) {\n    console.log(error);\n  } finally {\n        loader.classList.add(\"hidden\");\n    }\n};\n\n\n\n\n\n\n"],"names":["API_KEY","BASE_URL","fetchData","query","page","response","axios","error","iziToast","markupImg","cards","card","gallery","SimpleLightbox","inputData","searchQuery","totalPages","formData","formInput","galleryList","loader","btnLoadMore","formSubmit","onInput","loadMore","event","form","images","totalHits","newImg","itemHeight","cardHeight"],"mappings":"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"}